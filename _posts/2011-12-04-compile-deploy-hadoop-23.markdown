--- 
title: !binary |
  57yW6K+R77yP6YOo572yaGFkb29wIDAuMjM=

type: post
layout: post
tags: 
- Hadoop
- YARN
---
<ul><li><span style="font: 7pt "Times New Roman";"></span><span style="font-family: 宋体;">下载</span>hadoop 0.23<span style="font-family: 宋体;">版本，建议使用SVN</span></li><ul><li><span style="background-color: #999999;">svn checkout </span><a href="http://svn.apache.org/repos/asf/hadoop/common/tags/release-0.23.0-rc0/" style="background-color: #999999;">http://svn.apache.org/repos/asf/hadoop/common/tags/release-0.23.0-rc0/</a><span style="font: 7pt "Times New Roman";"> </span></li></ul></ul><ul><li><span style="font: 7pt "Times New Roman";"> </span><span style="font-family: 宋体;">进入</span>release-0.23.0-rc0<span style="font-family: 宋体;">，查看</span>INSTALL.TXT，提示编译hadoop0.23的前提：<span style="font-family: 宋体;"></span> </li></ul><ol><ol><li> <span style="font: 7pt "Times New Roman";"> </span>* Unix System<span style="font: 7pt "Times New Roman";"> </span></li><li><span style="font: 7pt "Times New Roman";">  </span>* JDK 1.6<span style="font: 7pt "Times New Roman";"> </span></li><li><span style="font: 7pt "Times New Roman";">  </span>* Maven 3.0<span style="font: 7pt "Times New Roman";"> </span></li><li><span style="font: 7pt "Times New Roman";">  </span>* Forrest 0.8 (if generating docs)<span style="font: 7pt "Times New Roman";"> </span></li><li><span style="font: 7pt "Times New Roman";">  </span>* Findbugs 1.3.9 (if running findbugs)<span style="font: 7pt "Times New Roman";"> </span></li><li><span style="font: 7pt "Times New Roman";">  </span>* ProtocolBuffer 2.4.1+ (for MapReduce)<span style="font: 7pt "Times New Roman";"> </span></li><li><span style="font: 7pt "Times New Roman";"> </span>* Autotools (if compiling native code)<span style="font: 7pt "Times New Roman";"> </span></li><li><span style="font: 7pt "Times New Roman";"> </span>* Internet connection for first build (to fetch all Maven and Hadoop dependencies)</li></ol></ol><ul><li>JDK是必须的，安装配置JDK，maven3.0并配置PATH变量</li><li>安装ProtocolBuffer</li><li>使用以下命令编译：  </li><ul style="background-color: #999999;"><li>mvn clean install -DskipTests </li><li>cd hadoop-mapreduce-project </li><li>mvn clean install assembly:assembly -Pnative </li></ul></ul> <span style="color: #e06666;">－－－－－－－－－－－－－－－－－－－－－－－－－－－－</span><br /><div style="color: #e06666;">[或者直接下载编译好的hadoop版本，以上步骤省略，直接从配置环境变量开始配置] </div><div style="color: #e06666;">下载地址：</div><div style="color: #e06666;">http://mirror.bjtu.edu.cn/apache/hadoop/common/hadoop-0.23.0/hadoop-0.23.0.tar.gz</div><div style="color: #e06666;">下载后解压 tar -zxvf hadoop-0.23.0.tar.gz</div><div style="color: #e06666;"> －－－－－－－－－－－－－－－－－－－－－－－－－－－－</div><ul><ul style="background-color: #999999;"></ul><li>配置环境变量（使用export）</li><ul><li><b>$HADOOP_COMMON_HOME</b> （指向common目录）</li><li><b>$HADOOP_MAPRED_HOME</b><b>   （指向mr目录）</b></li><li><b>$YARN_HOME（与HADOOP_MAPRED_HOME相同）</b></li><li><b>$HADOOP_HDFS_HOME</b>         （指向HDFS目录）</li><li><b>$YARN_HOME</b><b> </b></li><li><b>$JAVA_HOME</b><b> </b></li><li><b>$HADOOP_CONF_DIR （指向conf目录）</b></li><li><b>$YARN_CONF_DIR（与</b>$<b>HADOOP_CONF_DIR</b> 相同） </li></ul></ul><ul><li>配置／编写mapred-site.xml</li></ul><pre style="background-color: #999999;"><property><br />     <name>mapreduce.cluster.temp.dir</name><br />     <value></value><br />     <description>No description</description><br />     <final>true</final><br />   </property><br /><br />   <property><br />     <name>mapreduce.cluster.local.dir</name><br />     <value></value><br />     <description>No description</description><br />     <final>true</final><br />   </property></pre><pre style="background-color: #999999;"></pre><ul><li>配置／编写yarn-site.xml</li></ul>［<span style="color: #e06666;">其中的host换成你机器上hostname的输出值，port为端口号，自己定义，不能重复</span>］ <br /><ul></ul><pre style="background-color: #999999;"><property><br />    <name>yarn.resourcemanager.resource-tracker.address</name><br />    <value>host:port</value><br />    <description>host is the hostname of the resource manager and <br />    port is the port on which the NodeManagers contact the Resource Manager.<br />    </description><br />   </property><br /><br />   <property><br />    <name>yarn.resourcemanager.scheduler.address</name><br />    <value>host:port</value><br />    <description>host is the hostname of the resourcemanager and port is the port<br />    on which the Applications in the cluster talk to the Resource Manager.<br />    </description><br />  </property><br /><br />  <property><br />    <name>yarn.resourcemanager.scheduler.class</name><br />    <value>org.apache.hadoop.yarn.server.resourcemanager.scheduler.capacity.CapacityScheduler</value><br />    <description>In case you do not want to use the default scheduler</description><br />  </property><br /><br />  <property><br />    <name>yarn.resourcemanager.address</name><br />    <value>host:port</value><br />    <description>the host is the hostname of the ResourceManager and the port is the port on<br />    which the clients can talk to the Resource Manager. </description><br />  </property><br /><br />  <property><br />    <name>yarn.nodemanager.local-dirs</name><br />    <value></value><br />    <description>the local directories used by the nodemanager</description><br />  </property><br /><br />  <property><br />    <name>yarn.nodemanager.address</name><br />    <value>0.0.0.0:port</value><br />    <description>the nodemanagers bind to this port</description><br />  </property>  <br /><br />  <property><br />    <name>yarn.nodemanager.resource.memory-mb</name><br />    <value>10240</value><br />    <description>the amount of memory on the NodeManager in GB</description><br />  </property><br /> <br />  <property><br />    <name>yarn.nodemanager.remote-app-log-dir</name><br />    <value>/app-logs</value><br />    <description>directory on hdfs where the application logs are moved to </description><br />  </property><br /><br />   <property><br />    <name>yarn.nodemanager.log-dirs</name><br />    <value></value><br />    <description>the directories used by Nodemanagers as log directories</description><br />  </property><br /><br />  <property><br />    <name>yarn.nodemanager.aux-services</name><br />    <value>mapreduce.shuffle</value><br />    <description>shuffle service that needs to be set for Map Reduce to run </description><br />  </property></pre><ul><li> 创建符号链接： </li></ul>［<span style="color: #e06666;">只需创建一次，下次执行不必创建</span>］ <br /><ul></ul><pre style="background-color: #999999;">$ cd $HADOOP_COMMON_HOME/share/hadoop/common/lib/<br />$ ln -s $HADOOP_MAPRED_HOME/modules/hadoop-mapreduce-client-app-*-SNAPSHOT.jar .<br />$ ln -s $HADOOP_MAPRED_HOME/modules/hadoop-mapreduce-client-jobclient-*-SNAPSHOT.jar .<br />$ ln -s $HADOOP_MAPRED_HOME/modules/hadoop-mapreduce-client-common-*-SNAPSHOT.jar .<br />$ ln -s $HADOOP_MAPRED_HOME/modules/hadoop-mapreduce-client-shuffle-*-SNAPSHOT.jar .<br />$ ln -s $HADOOP_MAPRED_HOME/modules/hadoop-mapreduce-client-core-*-SNAPSHOT.jar .<br />$ ln -s $HADOOP_MAPRED_HOME/modules/hadoop-yarn-common-*-SNAPSHOT.jar .<br />$ ln -s $HADOOP_MAPRED_HOME/modules/hadoop-yarn-api-*-SNAPSHOT.jar . </pre><ul><li> 启动resourcemanager和nodemanager</li></ul>［<span style="color: #e06666;">如有问题，看logs下面的输出，可定位出错原因</span>］ <br /><ul></ul><pre style="background-color: #cccccc;"><span style="background-color: #999999;">$ cd $HADOOP_MAPRED_HOME<br />$ bin/yarn-daemon.sh start resourcemanager<br />$ bin/yarn-daemon.sh start nodemanager </span></pre><ul><li> 执行example中的例子：</li></ul>［<span style="color: #e06666;">hadoop.apache.org上给的命令还是copy0.20版本的，注意example.jar的路径</span>］ <br /><ul></ul><ul></ul><pre style="background-color: #999999;">$HADOOP_COMMON_HOME/bin/hadoop jar hadoop-mapreduce-examples-0.23.0.jar  randomwriter out </pre><br /> 看一下我的执行结果：<br /><span style="background-color: #444444; color: lime;">2011-12-04 16:08:34,907 INFO  mapred.LocalJobRunner (LocalJobRunner.java:statusUpdate(459)) - done with 102406 records.</span><br /><span style="background-color: #444444; color: lime;">2011-12-04 16:08:34,907 INFO  mapred.Task (Task.java:sendDone(1008)) - Task 'attempt_local_0001_m_000000_0' done.</span><br /><span style="background-color: #444444; color: lime;">2011-12-04 16:08:34,907 INFO  mapred.LocalJobRunner (LocalJobRunner.java:run(232)) - Finishing task: attempt_local_0001_m_000000_0</span><br /><span style="background-color: #444444; color: lime;">2011-12-04 16:08:34,908 INFO  mapred.LocalJobRunner (LocalJobRunner.java:run(352)) - Map task executor complete.</span><br /><span style="background-color: #444444; color: lime;">2011-12-04 16:08:35,762 INFO  mapreduce.Job (Job.java:monitorAndPrintJob(1227)) -  map 100% reduce 0%</span><br /><span style="background-color: #444444; color: lime;">2011-12-04 16:08:35,763 INFO  mapreduce.Job (Job.java:monitorAndPrintJob(1238)) - Job job_local_0001 completed successfully</span><br /><span style="background-color: #444444; color: lime;">2011-12-04 16:08:35,785 INFO  mapreduce.Job (Job.java:monitorAndPrintJob(1245)) - Counters: 20</span><br /><span style="background-color: #444444; color: lime;">    File System Counters</span><br /><span style="background-color: #444444; color: lime;">        FILE: BYTES_READ=251516</span><br /><span style="background-color: #444444; color: lime;">        FILE: BYTES_WRITTEN=1086056829</span><br /><span style="background-color: #444444; color: lime;">        FILE: READ_OPS=0</span><br /><span style="background-color: #444444; color: lime;">        FILE: LARGE_READ_OPS=0</span><br /><span style="background-color: #444444; color: lime;">        FILE: WRITE_OPS=0</span><br /><span style="background-color: #444444; color: lime;">    org.apache.hadoop.mapreduce.TaskCounter</span><br /><span style="background-color: #444444; color: lime;">        MAP_INPUT_RECORDS=1</span><br /><span style="background-color: #444444; color: lime;">        MAP_OUTPUT_RECORDS=102406</span><br /><span style="background-color: #444444; color: lime;">        SPLIT_RAW_BYTES=113</span><br /><span style="background-color: #444444; color: lime;">        SPILLED_RECORDS=0</span><br /><span style="background-color: #444444; color: lime;">        FAILED_SHUFFLE=0</span><br /><span style="background-color: #444444; color: lime;">        MERGED_MAP_OUTPUTS=0</span><br /><span style="background-color: #444444; color: lime;">        GC_TIME_MILLIS=0</span><br /><span style="background-color: #444444; color: lime;">        CPU_MILLISECONDS=0</span><br /><span style="background-color: #444444; color: lime;">        PHYSICAL_MEMORY_BYTES=0</span><br /><span style="background-color: #444444; color: lime;">        VIRTUAL_MEMORY_BYTES=0</span><br /><span style="background-color: #444444; color: lime;">        COMMITTED_HEAP_BYTES=62652416</span><br /><span style="background-color: #444444; color: lime;">    org.apache.hadoop.examples.RandomWriter$Counters</span><br /><span style="background-color: #444444; color: lime;">        BYTES_WRITTEN=1073747349</span><br /><span style="background-color: #444444; color: lime;">        RECORDS_WRITTEN=102406</span><br /><span style="background-color: #444444; color: lime;">    org.apache.hadoop.mapreduce.lib.input.FileInputFormatCounter</span><br /><span style="background-color: #444444; color: lime;">        BYTES_READ=0</span><br /><span style="background-color: #444444; color: lime;">    org.apache.hadoop.mapreduce.lib.output.FileOutputFormatCounter</span><br /><span style="background-color: #444444; color: lime;">        BYTES_WRITTEN=1085705129</span><br /><span style="background-color: #444444; color: lime;">Job ended: Sun Dec 04 16:08:35 CST 2011</span><br /><span style="background-color: #444444; color: lime;">The job took 20 seconds. </span><br />

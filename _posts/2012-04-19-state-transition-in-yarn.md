--- 
title: State Transition in YARN
type: post
layout: post
tags: 
- MapReduce
- YARN
---
<div style="clear: both; text-align: left;"><a href="http://1.bp.blogspot.com/-2NY4gRRLCtg/T4_R2dOf6bI/AAAAAAAABUM/uEhc23cMpnU/s1600/NodeManager.png" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"></a></div><div style="text-align: left;">在之前的一篇Post中，曾经给出过Hadoop MapReduce V2（Hadoop YARN）中Job/Task/Task Attempt的状态转换图。</div><div style="text-align: left;"><br /></div><div style="text-align: left;">其实这些图生成也很简单，两步：</div><ol style="text-align: left;"><li>在hadoop-common/hadoop-mapreduce-project/hadoop-yarn 目录写，使用maven编译代码时加上生成.gv的选项：<i>mvn compile -Pvisualize </i></li><li>使用graphviz工具，（可以使用sudo apt-get/yum install graphviz安装），将生成的gv格式文件转换为png图像，比如生成NodeManager的状态图：<i>dot -Tpng NodeManager.gv > NodeManager.png</i></li></ol><div style="text-align: left;">有了<i>状态图，</i>在查看Hadoop源码是，对dispatcher中的handle理解更透彻一些。</div><div style="text-align: left;"><br /></div><div style="text-align: left;">尤其在查看resourcemanager的代码时，event diapatcher的handle最终是调用stateMachine的doTransition，查看状态图，从当前的state，经过某个event，可以清晰的看到到达了什么state.</div><div style="text-align: left;"><br /></div><div style="text-align: left;">下面列出ResourceManager、NodeManager中的状态转换图（编译代码生成的）:<br /><span style="color: red;">{点击图片可看原图}</span></div><ul style="text-align: left;"></ul><h4 style="text-align: left;">   <b>Application</b></h4><ul style="text-align: left;"> </ul><div style="clear: both; text-align: left;"><a href="http://4.bp.blogspot.com/-0AghlQF1oNk/T4_QipE-7ZI/AAAAAAAABT0/EbwFDowpcgs/s1600/Application.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="363" src="http://4.bp.blogspot.com/-0AghlQF1oNk/T4_QipE-7ZI/AAAAAAAABT0/EbwFDowpcgs/s400/Application.png" width="400" /> </a> </div><h4 style="text-align: left;">   <b>Container （最重要的一张状态图）</b></h4><ul style="text-align: left;"> </ul><div style="clear: both; text-align: left;"><a href="http://3.bp.blogspot.com/-coqtd2ut-2Y/T4_Q7OCWcjI/AAAAAAAABT8/yW-byWDEj9g/s1600/Container.png" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="170" src="http://3.bp.blogspot.com/-coqtd2ut-2Y/T4_Q7OCWcjI/AAAAAAAABT8/yW-byWDEj9g/s400/Container.png" width="400" /></a></div><div style="text-align: left;"></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><h4 style="text-align: left;">   <b> </b></h4><h4 style="text-align: left;">   <b>LocalizedResource </b></h4><ul style="text-align: left;"> </ul><div style="text-align: left;"><a href="http://1.bp.blogspot.com/-WLomEDnX8rU/T4_Rf931qgI/AAAAAAAABUE/jNVkCSXqj5A/s1600/LocalizedResource.png" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="343" src="http://1.bp.blogspot.com/-WLomEDnX8rU/T4_Rf931qgI/AAAAAAAABUE/jNVkCSXqj5A/s400/LocalizedResource.png" width="400" /></a></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><h4 style="text-align: left;">   <b>RMAppAttempt</b></h4><ul style="text-align: left;"> </ul><div style="text-align: left;"><br /></div><div style="text-align: left;"><a href="http://4.bp.blogspot.com/-cyouXlScDGA/T4_R8ztFRyI/AAAAAAAABUk/KJZMxwR5Zoc/s1600/RMAppAttempt.png" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="400" src="http://4.bp.blogspot.com/-cyouXlScDGA/T4_R8ztFRyI/AAAAAAAABUk/KJZMxwR5Zoc/s400/RMAppAttempt.png" width="395" /></a></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><h4 style="text-align: left;">   <b>RMApp</b></h4><ul style="text-align: left;"> </ul><div style="text-align: left;"><a href="http://2.bp.blogspot.com/-HdAxi6B5j8o/T4_R7qNcGxI/AAAAAAAABUc/K5JT0piCCJc/s1600/RMApp.png" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="296" src="http://2.bp.blogspot.com/-HdAxi6B5j8o/T4_R7qNcGxI/AAAAAAAABUc/K5JT0piCCJc/s400/RMApp.png" width="400" /></a> </div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><h4 style="text-align: left;">   <b>RMContainer</b></h4><div style="text-align: left;"><a href="http://1.bp.blogspot.com/-hinos1tfi-I/T4_R-ksRiKI/AAAAAAAABUs/j7GIiUstK78/s1600/RMContainer.png" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="315" src="http://1.bp.blogspot.com/-hinos1tfi-I/T4_R-ksRiKI/AAAAAAAABUs/j7GIiUstK78/s400/RMContainer.png" width="400" /></a></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;">  </div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><h4 style="text-align: left;">   <b>RMNode </b></h4><ul style="text-align: left;"> </ul><div style="clear: both; text-align: left;"> <a href="http://4.bp.blogspot.com/-1hU_WYmK9jQ/T4_R_tVNeMI/AAAAAAAABUw/x44C7Y39mag/s1600/RMNode.png" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="281" src="http://4.bp.blogspot.com/-1hU_WYmK9jQ/T4_R_tVNeMI/AAAAAAAABUw/x44C7Y39mag/s400/RMNode.png" width="400" /></a></div>